# be-BOP Step-by-Step Documentation EN ðŸ‡¬ðŸ‡§

# 1. Installation and Initial Access

**1.1. Installation of be-BOP**

- **Prerequisites:**

    1. **Technical Infrastructure:**

        - **S3-Compatible Storage:** A service or solution (e.g., MinIO, AWS S3, Scaleway, etc.) with bucket configuration (S3_BUCKET, S3_ENDPOINT_URL, S3_KEY_ID, S3_KEY_SECRET, S3_REGION).

        - **MongoDB Database in ReplicaSet:** Either a local instance configured as a ReplicaSet or a service like MongoDB Atlas (variables MONGODB_URL and MONGODB_DB).

        - **Node.js Environment:** Node version 18 or higher, with Corepack enabled (`corepack enable`).

        - **Git LFS Installed:** To manage large files (command `git lfs install`).

    2. **Communication Configuration:**

        - **SMTP:** Valid SMTP credentials (SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASSWORD, SMTP_FROM) for sending emails and notifications.

    3. **Security and Notifications (at least one of the following):**

        - **Email:** An email account allowing SMTP configuration for sending notifications.

        - **Nostr Key (nsec):** An NSEC key (can be generated by be-BOP via the Nostr interface).

    4. **Supported Payment Methods:**

        - At least one payment method supported by be-BOP, such as:

            - Bitcoin

            - Lightning Network

            - PayPal

            - SumUp

            - Stripe

            - Bank transfers and cash payments require manual validation.

    5. **Knowledge of Your VAT Regime:**

        - It is essential to know the VAT regime applicable to your business (e.g., sales under the sellerâ€™s country VAT, exemption with justification, or sales at the buyerâ€™s country VAT rate) to correctly configure billing and VAT calculation options in be-BOP.

    6. **Currency Configuration:**

        - Clearly determine the primary currency to use, the secondary currency (if applicable), and, for a 100% BTC store, the reference currency for accounting.

    7. **Other Business Prerequisites:**

        - Have a clear vision of your order processes, inventory management, shipping fee policies, and payment and collection methods, both online and in-store.

        - Know the legal obligations (legal notices, terms of use, privacy policy) for setting up mandatory CMS pages.

- **Installation:** Deploy the application using the official installation script on your server and ensure all dependencies are correctly installed.

**1.2. Creating the Super-Admin Account**

- Go to **/admin/login**.

- Create your super-admin account by choosing a secure username and password. Prefer a passphrase of three or more words.

- This account will grant access to all back-office functionalities.

---

# 2. Securing and Configuring the Back-Office

**2.1. Securing Access**

- **Configuring the Access Hash:**

    - Navigate to **/admin/config** via the admin interface.

    - In the section dedicated to security (e.g., â€œAdmin hashâ€), set a unique string (hash).

    - Once saved, the back-office URL will change (e.g., **/admin-yourhash/login**) to restrict access to authorized users.

**2.2. Enabling Maintenance Mode (if needed)**

- In **/admin/config** (Config > Config via the graphical interface), check the **Enable maintenance mode** option at the bottom of the page.

- Optionally, specify a list of authorized IPv4 addresses (comma-separated) to allow front-office access during maintenance.

- The back-office remains accessible to administrators.

**2.3. Configuring Recovery Access via Email or Nostr**

- In **/admin/config**, via the ARM module, ensure the super-admin account includes a recovery email address or npub to facilitate password recovery.

**2.4. Configuring Language or Multilingual Settings**

- In **Admin > Config > Languages**, enable or disable the language selector depending on whether your site is multilingual or single-language (disable it for a single-language site).

**2.5. Configuring Layout, Logos, and Favicon**

- In **Admin > Merch > Layout**, configure the top bar, navbar, and footer.

    - Ensure the â€œDisplay powered by be-BOPâ€ option is enabled in the footer.

    - Set the logos for light and dark themes, as well as the favicon, via **Admin > Merch > Pictures**.

---

# 3. Configuring the Sellerâ€™s Identity

**3.1. Setting Up Identity**

- Go to **/admin/identity** (Config > Identity via the graphical interface) to enter all information related to your business:

    - **Company name**, **postal address**, **contact email** used for sending invoices and official communications.

    - **Billing information** (optional) that will appear in the top right corner of invoices.

- **Bank Account:**

    - To enable bank transfer payments, provide your IBAN and BIC.

**3.2. (For Physical Stores) Displaying the Store Address**

- For those with a physical store, duplicate the previous configuration in **/admin/identity** (or a dedicated section) by adding the full store address to display it on official documents and in the footer, if applicable.

---

# 4. Configuring Currencies

**4.1. Defining Currencies in /admin/config**

- **Primary Currency:**

    - This currency is displayed on the front-office and invoices.

- **Secondary Currency (optional):**

    - Can be used for display or as an alternative.

- **Reference Currency for Prices:**

    - Allows setting prices in a â€œstableâ€ currency.

    - Note: Clicking the confirmation button will recalculate all product prices without altering the entered amounts.

- **Accounting Currency:**

    - Used to track exchange rates in a fully Bitcoin-based be-BOP.

---

# 5. Configuring Payment Methods

You can set the duration of a pending payment in the **Admin > Config** panel.

**5.1. Bitcoin and Lightning Payments**

- **Bitcoin Nodeless (Onchain):**

    - In **Admin > Payment Settings > Bitcoin nodeless**, configure the module by selecting the BIP standard (currently only BIP84).

    - Enter the public key (in **zpub** format) generated with a compatible wallet (e.g., Sparrow Wallet).

    - Do not modify the derivation index, which starts at 0 and increments automatically.

    - Configure the URL of a block explorer to verify transactions (e.g., `https://mempool.space`).

- **PhoenixD for Lightning:**

    - Install PhoenixD on your server following the instructions at [https://phoenix.acinq.co/server/get-started](https://phoenix.acinq.co/server/get-started).

    - In **Admin > Payment Settings > PhoenixD**, provide the URL of your instance (if using Docker, consider network specifics) and add the PhoenixD HTTP password. If PhoenixD is installed on the same server as be-BOP, click the **Detect PhoenixD Server** button.

**For Power Users**

It is possible to use a full Bitcoin node and LND via the `.env` file using RPC credentials (+TOR recommended) for a remote node. Alternatively, you can install Bitcoin Core and LND on the same local network as your be-BOP.

- **Bitcoin Core:**

    - In **Admin > Payment Settings > Bitcoin core node**.

- **Lightning LND:**

    - In **Admin > Payment Settings > Lightning LND node**.

**5.2. PayPal Payment**

- In **Admin > Payment Settings > PayPal**, enter your Client ID and Secret obtained from your PayPal developer account at [https://developer.paypal.com/api/rest/](https://developer.paypal.com/api/rest/).

- Check **Those credentials are for the sandbox environment** if you want to use Sandbox mode (for testing) or leave it unchecked for production mode.

**5.3. SumUp Payment**

- In **Admin > Payment Settings > SumUp**, enter your API Key and Merchant Code at [https://developer.sumup.com/api](https://developer.sumup.com/api).

- The currency used corresponds to your SumUp account currency (typically the currency of your businessâ€™s country).

**5.4. Stripe Payment**

- In **Admin > Payment Settings > Stripe**, enter your Secret Key and Public Key at [https://docs.stripe.com/api](https://docs.stripe.com/api).

- The currency used corresponds to your Stripe account currency (typically the currency of your businessâ€™s country).

---

# 6. Product Management

**6.1. Creating a New Product**

- Go to **Admin > Merch > Products** to add or edit a product.

- **Basic Information:**

    - Enter the **Product name**, **slug** (unique identifier for the URL), and, if necessary, an **alias** to simplify adding via the cartâ€™s dedicated field. For products sold online (not Point of Sale), an alias is not required.

- **Pricing:**

    - Set the price in **Price Amount** and select the currency in **Price Currency**. You can also create free or pay-what-you-want products by checking the **This is a free product** and **This is a pay-what-you-want product** options, respectively.

    - **Product Options:**

        - Indicate if the product is standalone (single addition per order) or has variations (e.g., a t-shirt in S, M, L, XL is not standalone).

        - For products with variations, enable the **Product has light variations (no stock difference)** option and add variations (name, value, and price difference).

**6.2. Inventory Management**

- For products with limited stock, check **The product has a limited stock** and enter the available quantity.

- The system also displays reserved stock (in pending orders) and sold stock.

- You can adjust the duration (in minutes) for which a product is considered reserved in a pending cart in **Admin > Config**.

---

# 7. Creating and Customizing CMS Pages and Widgets

**7.1. Mandatory CMS Pages**

- Create essential pages in **Admin > Merch > CMS**, such as:

    - `/home` (homepage),

    - `/error` (error page),

    - `/maintenance` (maintenance page),

    - `/terms`, `/privacy`, `/why-vat-customs`, `/why-collect-ip`, `/why-pay-reminder` (legal and mandatory information pages).

- These pages provide visitors with legal information, contact details, and explanations about your storeâ€™s operations.

- You can add as many additional pages as needed.

**7.2. Layout and Graphic Elements**

- Go to **Admin > Merch > Layout** to customize your top bar, navbar, and footer.

- Modify links, logos (via **Admin > Merch > Pictures**), and your siteâ€™s description.

**7.3. Integrating Widgets into CMS Pages**

- Create various widgets in **Admin > Widgets**, such as Challenges, Tags, Sliders, Specifications, Forms, Countdowns, Galleries, and Leaderboards.

- Use specific tags to integrate dynamic elements, for example:

    - To display a product: `[Product=slug?display=img-1]`

    - To display an image: `[Picture=slug width=100 height=100 fit=contain]`

    - To integrate a slider: `[Slider=slug?autoplay=3000]`

    - To add a challenge, countdown, form, etc., use `[Challenge=slug]`, `[Countdown=slug]`, `[Form=slug]`, respectively.

---

# 8. Order Management and Reporting

**8.1. Tracking Orders**

- In **Admin > Transaction > Orders**, view the list of orders.

- Use available filters (Order Number, Product alias, Payment Mean, Email, etc.) to refine your search.

- You can view order details (ordered products, customer information, shipping address) and manage the order status (confirm, cancel, add labels, view order notes).

**8.2. Reporting and Export**

- Go to **Admin > Config > Reporting** to view monthly and annual statistics for orders, products, and payments.

- Each section (Order Detail, Product Detail, Payment Detail) includes an **Export CSV** button to download the data.

---

# 9. Configuring Nostr Messaging (Optional)

**9.1. Configuring the Nostr Key**

- In **Admin > Node Management > Nostr**, click **Create an nsec** if you donâ€™t already have one.  
    **NOTE:** If youâ€™ve already generated and configured your nsec via a Nostr client and added it to your `.env` file, skip this step.

- Copy the NSEC key generated by yourself or be-BOP and add it to your **.env.local** file under the `NOSTR_PRIVATE_KEY` variable.

**9.2. Associated Features**

- This configuration enables sending notifications via Nostr, activating the lightweight admin client, and offering passwordless logins via temporary links.

---

# 10. Customizing Design and Themes

- In **Admin > Merch > Theme**, create a theme by defining colors, fonts, and styles for the header, body, footer, etc.

- Once created, apply it as the active theme for your store.

---

# 11. Configuring Email Templates

- Go to **Admin > Config > Templates** to configure email templates (e.g., for password resets, order notifications, etc.).

- For each template, provide the **Subject** and **HTML body**.

- Templates support variables such as `{{orderNumber}}`, `{{invoiceLink}}`, `{{websiteLink}}`, etc.

---

# For Advanced Users...

# 12. Configuring Tags and Specific Widgets

**12.1. Managing Tags**

- In **Admin > Widgets > Tag**, create tags to organize products or enhance CMS pages.

- Provide the **Tag name**, **slug**, select the **Tag Family** (Creators, Retailers, Temporal, Events), and complete optional fields (title, subtitle, short and full content, CTAs).

**12.2. Integration via CMS**

- To integrate a tag into a page, use the syntax:  
    `[Tag=slug?display=var-1]`

# 13. Configuring Downloadable Files

**Adding a File**

- In **Admin > Merch > Files**, click **New file**.

- Provide the **file name** (e.g., â€œProduct manualâ€) and upload the file via the **Browseâ€¦** button.

- Once added, a permanent link is generated and can be used in CMS pages to share the file.

# 14. Nostr-Bot

In the **Node Management > Nostr** section, you can configure your Nostr interface to send notifications and interact with customers. Available options include:

- Managing the list of relays used by your Nostr bot.

- Enabling or disabling the automatic introduction message sent by the bot.

- Certifying your npub by associating it with a logo, name, and domain (alias Lightning BOLT12 for Zaps).

# 15. Overriding Translation Labels

While be-BOP is available in multiple languages (English, French, Spanish, etc.), you can customize translations to suit your needs. Go to **Config > Languages** to load and edit the JSON translation files. These files for each language are available in our official repository at:  
[https://github.com/be-BOP-io-SA/be-BOP/tree/main/src/lib/translations](https://github.com/be-BOP-io-SA/be-BOP/tree/main/src/lib/translations)

---

# PART 2: Teamwork and POS

# 1. Managing Users and Access Rights

**1.1. Creating Roles**

- In **Admin > Config > ARM**, click **Create a role** to define roles (e.g., Super Admin, Point of Sale, Ticket Checker).

- For each role, specify:

    - Paths for **write access** and **read access**.

    - Paths restricted via **Forbidden access**.

**1.2. Managing Users**

- In **Admin > Users**, create or edit users by providing:

    - The **login**, **alias**, **recovery email**, and, if applicable, **Recovery npub**.

    - Assign the appropriate role to each user.

- Users with read-only access will see menus in italics and cannot make changes.

# 2. Configuring the Point of Sale (POS) for In-Store Sales

**2.1. Assigning and Accessing POS**

- Assign the **Point of Sale (POS)** role via **Admin > Config > ARM** to the user managing the cash register.

- POS users log in via the secure identification page and are redirected to the dedicated interface (e.g., **/pos** or **/pos/touch**).

**2.2. POS-Specific Features**

- **Quick Add via Alias:** In **/cart**, the alias field allows scanning a barcode (ISBN, EAN13) to add the product directly.

- **POS Payment Options:**

    - Support for multi-mode payments (cash, card, Lightning, etc.).

    - Options for VAT exemption or gift discounts with mandatory managerial justification.

- **Client-Side Display:**

    - On a dedicated screen (e.g., tablet or external monitor via HDMI), display the **/pos/session** page for clients to track their order progress.